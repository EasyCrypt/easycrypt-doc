
\section{Lexical conventions}


%\section{Syntax}
\newenvironment{ecgrammar}{\bgroup\framed\grammar}{\endgrammar\endframed\egroup}

%\setlength{\grammarparsep}{20pt plus 1pt minus 1pt} % increase separation between rules
\setlength{\grammarindent}{8em} % increase separation between LHS/RHS 

% \small


\subsubsection*{Comments.}
Comments are enclosed by $(*$ and $*)$.


\subsubsection*{Strings.}


\subsubsection*{Identifiers.}

\begin{ecgrammar}
<letter> := `a' - `z' | `A' - `Z' | `_'

<digit> ::= `0' - `9'

<other_letter> ::= <letter> | <digit> | `\''

<ident> ::= <letter> <other_letter>$^*$

<ident_list> ::=  <ident> | <ident> `,'  <ident_list>

<ident_list0> ::= <empty> | <ident_list>

<prim_ident> ::= `\'' <ident>

<prim_ident_list> ::= <prim_ident> | <prim_ident_list> `,' <prim_ident_list>

<number_list> ::= <number> | <number> `,' <number_list>

<qualif_fct_name>  ::= <ident>`.'<ident>

<number> ::= <digit>$^+$

<znumber> ::= <number> | `-'<number>
\end{ecgrammar}

\subsubsection*{Keywords.} The following literals are reserved and must
not be used as identifiers:
\begin{verbatim}
\end{verbatim}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                     Operators 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection*{Operators.}
\begin{ecgrammar}

<op_char> ::= `=' | `<' | `>' | `~' | `+' | `-' | `*' | `/' | `\%'
          \alt `!' | `\$' | `&' | `?' | `@' |  `^' | `.' | `:' | `|' |  `#'

<bin_op> ::= <op_char>$^+$

<u_op> :: = `-' | `!'

<op_ident> ::= <ident> | `(' <bin_op>$^+$ `)'
\end{ecgrammar}





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                              Type Expressions 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Type Expressions.}
\begin{ecgrammar}
<type> ::=  <ident>
       \alt ' <ident>
       \alt <type> <ident>
       \alt ( <type> (`,' <type>)$^+$ ) <ident>
       \alt ( <type> (`*' <type>)$^+$ )
       \alt `bitstring' `{' <type> `}'
       \alt `(' <type> `)'

<typed_vars> ::=  <ident_list> `:'  <type>

<typed_var_list> ::= <typed_vars> | <typed_vars> `,'  <typed_var_list>

<param_list> ::= <empty> | <typed_var_list> 

<param_decl> ::= `(' <param_list> `)'

<type_list> ::=  <type> `,' <type>
           \alt <type> `,' <type_list>

<type_list0> ::=  <type>
             \alt `(' <type_list> `)'
             \alt `()'

<fun_type> ::= <type_list0> `->' <type> 

<fun_type_list> ::= <fun_type> | <fun_type> `;' <fun_type_list>

<fun_type_list0> ::= <empty> | <fun_type_list>

\end{ecgrammar}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                         Terms
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Expressions.}

\subsubsection*{Simple expressions:}
\begin{ecgrammar}
<simpl_exp> ::=  <number>
            \alt <ident>
            \alt <simpl_exp> `[' <exp> `]'  
            \alt <simpl_exp> `[' <exp> `<-' <exp> `]' 
            \alt <ident> `(' <exp_list0> `)'
            \alt <simpl_exp> `{' `{'<number>`}' `}' 
            \alt <simpl_exp> `\%r' 
            \alt <qualif_fct_name> `[' <exp> `]' 
            \alt `(' <exp> `,' <exp_list> `)' 
            \alt `(' <exp> `)'
            \alt `[' <exp_list> `]'
            \alt `=' `{' <pos_ident_list> `}'
            \alt `|' <exp> `|'
            \alt <simpl_exp> `{'<number>`}'
\end{ecgrammar}

\subsubsection*{Random expressions:}
\begin{ecgrammar}
<rnd_exp> ::=  `{' <number> `,' <number> `}' 
          \alt `{' <number> `,' <number> `}^' <exp>
          \alt `[' <exp> `..' <exp> `]'
          \alt `('<rnd_exp> `\\' <exp> `)' 
\end{ecgrammar}

\subsubsection*{General expressions:}
\begin{ecgrammar}
<exp> ::=  <exp> <bin_op>  <exp>
      \alt <u_op> <exp>   
      \alt <exp> `?' <exp> `:' <exp> 
      \alt `if' <exp> `then' <exp> `else' <exp>
      \alt `forall' <param_decl> [`['<trigger_list>`]'] `,' <exp>
      \alt `exists' <param_decl> [`['<trigger_list>`]'] `,' <exp> 
      \alt `let'  <ident_list> `=' <exp> `in' <exp>
      \alt <simpl_exp>
      \alt <rnd_exp>

<trigger_list> ::= <trigger> |  <trigger> `|' <trigger_list> 

<trigger> ::= <exp> | <exp> `,' <trigger>


\end{ecgrammar}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                               Global Elements 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Declarations.}

%                                                                  Element.type
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection*{type}
\begin{ecgrammar}
<poly_type> ::= `(' <prim_ident_list> `)' | <prim_ident>

<type_elem> ::=  `type' [<poly_type>] <ident> 
            \alt `type' [<poly_type>] <ident> `=' <type>
\end{ecgrammar}

%                                                                  Element.cnst
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection*{cnst}
\begin{ecgrammar}
<cnst_elem> ::=  `cnst' <ident_list> `:' <type>
            \alt `cnst' <ident_list> `:' <type>  `=' <exp> 
\end{ecgrammar}

%                                                                    Element.op
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection*{op}
\begin{ecgrammar}
<op_body> ::= `:' <fun_type> 
          \alt <param_decl> `=' <exp> 

<op_elem> ::= `op' <op_ident> <op_body> 
          \alt`op' <op_ident> <op_body> `as' <ident> 
\end{ecgrammar}

%                                                                   Element.pop
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection*{pop}
\begin{ecgrammar}
<pop_elem> ::= `pop' <op_ident> `:' <fun_type>
\end{ecgrammar}

%                                                                  Element.pred
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection*{pred}
\begin{ecgrammar}
<pred_elem> ::=  `pred' <ident> <param_decl> `=' <exp>
            \alt `pred' <ident> `:' <type_ist> 
\end{ecgrammar}

%                                                                 Element.axiom
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection*{axiom}
\begin{ecgrammar}
<axiom_elem> ::=  `axiom' <ident> `:' <exp>
             \alt `lemma' <ident> `:' <exp>
\end{ecgrammar}

%                                                             Element.adversary
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection*{adversary}
\begin{ecgrammar}
<adv_elem> ::= `adversary' <fun_decl> `{' <fun_type_list0> `}' 
\end{ecgrammar}

%                                                                  Element.game
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection*{Games.}
\begin{ecgrammar}

<base_instr> ::= <ident> `('<exp_list0> `)'
 \alt <ident> `=' <exp> 
 \alt `(' <ident_list> `)' `=' <exp> 
 \alt <ident> `[' <exp> `]' `=' <exp> 

<instr> ::= <base_instr> ;
 \alt `if' `(' <exp> `)' <block> `else' <block> 
 \alt `if' `(' <exp> `)' <block>
 \alt `while' `(' <exp> `)' <block> 

<block> ::= <base_instr> `;' 
 \alt `{' <stmt> `}' 

<stmt> ::= <instr> <stmt>
 \alt <empty>


<ret_stmt> ::= `return' <exp> `;'

<loc_decl> ::= `var' <ident_list> `:' <type> [`=' <exp> ]`;'

<loc_decl_list> ::= <loc_decl>$^+$ 

<fun_def_body> ::= `{' [<loc_decl_list>] <stmt> [<ret_stmt>] `}' 

<fun_decl> ::= <ident> <param_decl> `:' <type> 

<pg_elem> ::= 
      `var' <ident_list> `:' <type> 
 \alt `fun' <fun_decl> `=' <fun_def_body>
 \alt `fun' <ident> `=' <qualif_fct_name> 
 \alt `abs' <ident> `=' <ident> `{' <ident_list0> `}' 

<game_elem> ::= `game' <ident> `=' `{' <pg_elem>$^*$ `}'
 \alt `game' <ident> `=' <ident> <var_modifier> `where' <redef_list>

\end{ecgrammar}




%                                                                 Element.equiv
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{pRHL judgments}
\subsubsection*{equiv}
\begin{ecgrammar}

<inv_info> ::=
  `(' <exp> `)'          
 \alt `upto' `(' <exp> `)' [`and' `(' <exp> `)' ] [`with' `(' <exp> `)'] 


<auto_info> ::=
  [<inv_info>] [`using' <ident_list>]

 

<equiv_concl> ::=
      <exp> `==>' <exp>
 \alt <exp> `=' `(' <exp> `:' <exp> `)' `=>' <exp>
 \alt <inv_info> 

<equiv_elem> ::= 
      `equi' <ident> `:' <qualif_fct_name> `~' <qualif_fct_name> `:' <equiv_concl>
 \alt `equi' <ident> `:' <qualif_fct_name> `~' <qualif_fct_name> `:' <equiv_concl> `by' `auto' <auto_info> 
 \alt `equi' <ident> `:' <qualif_fct_name> `~' <qualif_fct_name> `:' <equiv_concl> `by' `eager' <block>

\end{ecgrammar}



%                                                               Element.tactics
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Tactics}
\begin{ecgrammar}
<interval> ::= `[' <number> `-' <number> `]' | <number> 

<rnd_info> ::= `(' <exp> `)' `,' `(' <exp> `)' | `(' <exp> `)' | `{' <number>`}'

<side_at_pos> ::= [`{'<number>`}'] [`at' <number_list> | `last']
 
<inline_info> ::= `at' <number_list> | `last' | <ident_list>

<tactic> ::= `idtac'
 \alt `call' <auto_info>
 \alt `inline' [`{'<number>`}'] [<inline_info>]
 \alt `asgn'
 \alt `rnd' [<rnd_info>]
 \alt `swap' [`{'<number>`}'] <interval> <znumber> 
 \alt `swap' [`{'<number>`}'] <znumber>  
 \alt `simpl'
 \alt `trivial'
 \alt `auto'  <auto_info>
 \alt `rauto' <auto_info>
 \alt `derandomize' [`{'<number>`}']
 \alt `wp'
 \alt `case'  [`{'<number>`}'] `:' <exp>
 \alt `if'    [`{'<number>`}']
 \alt `condt'   <side_at_pos> 
 \alt `condf'   <side_at_pos> 
 \alt `while' <side_at_pos> `:' <exp>
 \alt `while' <side_at_pos> `:' <exp> `:' <exp> `,' <exp> 
 \alt `while' <exp> `,' <exp> `,' <exp>  `,' <exp> `,' <exp> `:' <exp>     
 \alt `apply' <ident> `(' <exp_list0> `)'
 \alt `pRHL'
 \alt `apRHL'
 \alt `unroll'     <side_at_pos>
 \alt `strengthen' <side_at_pos>  `:' <exp>
 \alt `app' <number> <number> <exp>
 \alt `app' <number> <number> <exp> `:' <exp> `,' <exp> `:' <exp> `,' <exp> 
 \alt `try' <tactics_paren>
 \alt `*' <tactics_paren>
 \alt `!' <number> <tactics_paren>
 \alt `admit'
 \alt `expand' <ident_list0>
 \alt `let' <side_at_pos>  <ident> `:' <type> `=' <exp> 


<subgoal_tactics> ::= [<tactics>] `|' <subgoal_tactics> | [<tactics>]

<tactic2> ::= <tactic> | `[' <subgoal_tactics> `]' | `('<tactics>`)'

<tactic_list> ::= <tactic2> `;' <tactic_list> | <tactic2>

<tactics> ::= <tactic> `;' <tactic_list> | <tactic>

<tactics_paren> ::= <tactic> | `(' <tactics> `)'

\end{ecgrammar}

%                                                                 Element.claim
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Probability claims}
\subsubsection*{claim}
\begin{ecgrammar}
<claim_elem> ::=  
      `claim' <ident> `:' <exp>
 \alt `claim' <ident> `:' <exp> `admit'
 \alt `claim' <ident> `:' <exp> `compute'
 \alt `claim' <ident> `:' <exp> `split'
 \alt `claim' <ident> `:' <exp> `same'
 \alt `claim' <ident> `:' <exp> `using' <ident>
 \alt `claim' <ident> `:' <exp> `compute' <number> <exp> `,' <exp>
\end{ecgrammar}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                       Program
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Program}
\begin{ecgrammar}

<global_elem> ::=  `include' `"' <string> `"'          %{ Ginclude $2 } 
              \alt <type_elem>                         %{ Gtype $1 }
              \alt <cnst_elem>                         %{ Gcnst $1 }
              \alt <op_elem>                           %{ Gop (get_pos(),$1) }
              \alt <pop_elem>                          %{ Gpop $1 }
              \alt <pred_elem>                         %{ Gpred $1 }
              \alt <axiom_elem>                        %{ Gaxiom $1 }
              \alt <adv_elem>                          %{ Gadv $1 }
              \alt <game_elem>                         %{ Ggame $1 }
              \alt <equiv_elem>                        %{ Gequiv $1 }
              \alt <claim_elem>                        %{ Gclaim $1  }
              \alt <tactics>                           %{ Gtactic $1 }
              \alt `save'                              %{ Gsave }
              \alt `abort'                             %{ Gabort }
              \alt `set' <ident_list>                  %{ Gset $1 }
              \alt `unset' <ident_list>                %{ Gset $1 }
              \alt `prover' <prover_list>              %{ Gprover $2}
              \alt `checkproof'                        %{ Gwithproof }
              \alt `transparent' <ident_list>          %{ Gopacity(false,$2) }
              \alt `opaque' <ident_list>               %{ Gopacity(true,$2) }
              \alt `timeout' <number>                  %{ Gtimeout $2 }
              \alt `check' <check>                     %{ Gcheck $1 }
              \alt `print' <print>                     %{ Gprint $1 }

<program> ::=  <global_elem> `.'
          \alt <global_elem> `.' <program>

\end{ecgrammar} 



%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "easycrypt"
%%% End: 
